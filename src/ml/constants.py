"""
機械学習モジュールの定数定義。

このモジュールはML関連のマジックナンバーを名前付き定数として定義します。
すべての定数には、その意味と選択理由のコメントが付いています。
"""
from typing import Final

# ============================================================================
# 特徴量抽出関連の定数
# ============================================================================

# 過去データの参照期間（日数）
LOOKBACK_DAYS_DEFAULT: Final[int] = 730
"""デフォルトの過去データ参照期間（2年分）
- 理由: 2年分のデータがあれば季節性やコース特性を十分に捉えられる
- 短すぎるとデータ不足、長すぎると古すぎるデータの影響が大きくなる
"""

# 最近のレース数（トレンド分析用）
RECENT_RACES_COUNT: Final[int] = 3
"""最近のレース回数（直近の調子を見る）
- 理由: 競走馬の調子は直近3レース程度で判断できる
- これより多いと古いデータの影響が強くなる
"""

# 最小サンプルサイズ（統計的信頼性）
MIN_SAMPLE_SIZE_FOR_STATS: Final[int] = 5
"""統計計算に必要な最小サンプル数
- 理由: 5レース未満では統計的に信頼性が低い
- この場合は全体平均を使用する
"""

# ============================================================================
# 馬券シミュレーション関連の定数
# ============================================================================

# 複勝確率の調整係数
PLACE_PROBABILITY_MULTIPLIER: Final[float] = 3.0
"""複勝確率の計算時の乗数
- 理由: 複勝（3着以内）は単勝の約3倍の確率
- 実際のデータ分析から導出された経験的な値
"""

# 複勝確率の上限
PLACE_PROBABILITY_MAX: Final[float] = 0.95
"""複勝確率の最大値
- 理由: どんなに強い馬でも確実ではない
- 95%を上限とすることでリスクを考慮
"""

# 馬連・ワイド確率の調整係数
COMBINATION_PROBABILITY_FACTOR: Final[float] = 0.5
"""馬連・ワイド確率の調整係数
- 理由: 2頭の組み合わせなので、単純な積より低くなる
- prob1 * prob2 * 0.5 で実際の確率に近づく
"""

# 3連複確率の調整係数
TRIO_PROBABILITY_FACTOR: Final[float] = 0.3
"""3連複確率の調整係数
- 理由: 3頭の組み合わせは難易度が高い
- prob1 * prob2 * prob3 * 0.3 で実際の確率に近づく
"""

# デフォルトの馬券購入金額（円）
DEFAULT_BET_AMOUNT: Final[int] = 100
"""デフォルトの馬券購入金額
- 理由: 最小単位の100円
- シミュレーション時の基準金額
"""

# デフォルトの上位N頭（購入対象）
DEFAULT_TOP_N_HORSES: Final[int] = 3
"""デフォルトで馬券を購入する上位頭数
- 理由: 3頭程度が的中率と回収率のバランスが良い
- これ以上増やすと購入点数が多くなりすぎる
"""

# 最小購入確率閾値
MIN_BET_PROBABILITY: Final[float] = 0.1
"""馬券購入の最小確率閾値（10%）
- 理由: 10%未満の確率では期待値が低すぎる
- リスク管理のための下限値
"""

# 1レースあたりの最大購入点数
MAX_BETS_PER_RACE: Final[int] = 10
"""1レースあたりの最大馬券購入点数
- 理由: 購入しすぎると資金管理が困難
- 10点以内に抑えることでリスクを制限
"""

# ============================================================================
# モデル学習関連の定数
# ============================================================================

# 学習・テストデータ分割比率
TRAIN_TEST_SPLIT_RATIO: Final[float] = 0.2
"""テストデータの割合（20%）
- 理由: 一般的な機械学習のベストプラクティス
- 80%学習、20%テストでバランスが良い
"""

# ランダムシード（再現性確保）
RANDOM_STATE: Final[int] = 42
"""ランダムシードの固定値
- 理由: 結果の再現性を確保するため
- 42は慣習的に使われる値（「銀河ヒッチハイク・ガイド」由来）
"""

# クロスバリデーションのfold数
CV_FOLDS: Final[int] = 5
"""クロスバリデーションの分割数
- 理由: 5-foldが一般的でバランスが良い
- 計算コストと精度のトレードオフ
"""

# Early Stopping のpatience
EARLY_STOPPING_PATIENCE: Final[int] = 10
"""Early Stoppingの忍耐回数
- 理由: 10エポック改善がなければ学習停止
- 過学習を防ぎ、学習時間を短縮
"""

# ============================================================================
# オッズ関連の定数
# ============================================================================

# デフォルトオッズ（オッズ未取得時）
DEFAULT_ODDS: Final[float] = 10.0
"""オッズが取得できない場合のデフォルト値
- 理由: 中程度の人気馬のオッズ
- 10倍程度が平均的な値
"""

# 最小オッズ（大本命）
MIN_ODDS: Final[float] = 1.0
"""最小オッズ（大本命馬）
- 理由: 競馬では1.0倍未満はない
- 下限値として設定
"""

# 最大オッズ（大穴）
MAX_ODDS: Final[float] = 999.9
"""最大オッズ（大穴馬）
- 理由: netkeibaでの表示上限
- 実質的な上限値
"""

# ============================================================================
# スクレイピング関連の定数（参考用）
# ============================================================================

# 注意: スクレイピング関連の定数はconfig/settings.pyで管理されています
# - SCRAPING_DELAY: リクエスト間隔（秒）
# - MAX_RETRIES: 最大リトライ回数
# - REQUEST_TIMEOUT: リクエストタイムアウト（秒）
